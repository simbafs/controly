# Controly

[English](/README.md)

一個可以從其他裝置，透過動態生成的控制面板，遠端控制網頁的框架。

## 核心概念

想像一個情境：當有一個網頁正在顯示某些內容，但想用另一個裝置上的控制面板來操作它。Controly 就是為這種情況設計的。

首先建立 **顯示頁面**（被控制的頁面），在一個 `command.json` 檔案中定義可用的操作，並使用 Controly SDK 連接到一個通用的 **伺服器**。然後，伺服器會根據 `command.json` 自動生成一個 **控制頁面**。

這種架構的主要優點是：

- **通用伺服器**：伺服器是通用的。它只需要接收來自不同顯示頁面的不同 `command.json` 檔案，就能生成不同的控制面板。
- **靜態顯示頁面**：由於顯示頁面本身不需要後端，因此它完全是靜態的。可以將它託管在任何可以託管靜態網站的地方（例如 GitHub Pages、Cloudflare Pages、Vercel 等）。
- **簡易的 SDK**：SDK 提供了一種直接的方式來連接伺服器和處理指令，讓開發者可以專注於顯示頁面的邏輯。

## 架構

```
+-----------------+      +-------------------+      +-------------------+
|                 |  WS  |                   |  WS  |                   |
|    控制頁面     |<---->|  Controly 伺服器  |<---->|     顯示頁面      |
| （你的瀏覽器）  |      |    (Go 後端)      |      | （例如：在電視上）|
|                 |      |                   |      |                   |
+-----------------+      +-------------------+      +-------------------+
          ^                              | 請求          |
          |                              V               v
          |                           +---------------------+
          |                           |                     |
          +---------------------------|    command.json     |
                     生成             |   （定義控制項）    |
                                      |                     |
                                      +---------------------+
```

## 如何使用

建立自己的遠端控制頁面非常簡單。基本步驟如下：

1.  **設定靜態網站專案**：使用像 Vite 這樣的打包工具。
2.  **建立 `command.json`**：在 `public` 目錄中，定義希望在控制頁面上顯示的控制項。
3.  **在程式碼中使用 SDK**：
    - 從 `controly` 匯入並初始化 `Display`。
    - 為 `open` 事件設定處理程序（以獲取控制器 ID）。
    - 使用 `display.command()` 設定指令處理程序。
    - 呼叫 `display.connect()`。
4.  **部署**：建置專案並將靜態檔案託管在任何地方。

關於一個完整且可運作的範例，請參考本儲存庫中的 [countdown](./countdown) 目錄。它清楚地展示了如何建構專案以及如何使用 SDK。

## 打造你自己的控制器

雖然伺服器提供了一個預設的通用控制器，足以應付大多數情況，但你也可以靈活地建立一個完全客製化的控制器。

`controly` 匯出了一個 `Controller` 類別，讓你可以建立自己的控制器介面。這使你能夠完全控制遙控器的外觀和功能。

關於一個完整的實作範例，請參閱 [`/server/controller`](./server/controller/) 目錄中的程式碼。它作為預設控制器的基礎，也是打造自己控制器時的絕佳參考。

## 專案結構

- `/sdk`: 用於顯示頁面的 TypeScript SDK。
- `/server`: 通用的 Go 伺服器，處理 WebSocket 連線並提供控制器頁面。
- `/countdown`: 一個範例專案，示範如何使用 SDK 建立一個可控制的倒數計時器。

## 授權

本專案採用 [MIT 授權](LICENSE)。
